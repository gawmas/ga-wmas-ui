<hunt-filters />

<table class="w-[95%] text-sm text-left text-gray-300 -pt-2">
  @if (screenWidth() > 1000) {
    <thead class="text-xs text-gray-400 uppercase bg-gray-800 border-gray-400 border-b-2 border-t-1">
      <tr>
        <th scope="col" class="px-6 py-3">WMA &amp; Season</th>
        <th scope="col" class="px-6 py-3 w-[200px]">Dates</th>
        <th scope="col" class="px-6 py-3 w-[150px] text-center">Results</th>
        <th scope="col" class="px-6 py-3 w-[300px] text-center">Weather</th>
      </tr>
    </thead>
    <tbody>
      @if ((hunts$ | async); as hunts) {
        @for (hunt of hunts; track hunt.id) {
          <tr class="border-b bg-gray-800 border-gray-500">
            <td class="px-6 py-4 align-top bg-gray-800">
              <div class="flex flex-wrap items-center mb-1">
                @if (hunt.physLat && hunt.physLong) {
                  <a href="https://www.google.com/maps/search/?api=1&query={{ hunt.physLat }},{{ hunt.physLong }}" target="_blank">
                    <ng-icon name="heroMapPin" class="mr-1"></ng-icon>
                  </a>
                }
                <div class="text-white font-bold uppercase mr-1">
                  {{ hunt.wmaName }}
                </div>
                @switch (hunt.weapon) {
                  @case ('Firearms') {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-gray-700 text-gray-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                  @case ('Archery') {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-green-900 text-green-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                  @case ('Primitive') {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-yellow-900 text-yellow-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                  @default {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-gray-700 text-gray-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                }
              </div>
              <span class="text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-blue-900 text-blue-300">
                {{ hunt.season }}
              </span>
              @if (hunt.quota) {
                <span class="text-sm font-medium me-2 px-2.5 py-0.5 rounded-full bg-red-900 text-red-300">
                  <span class="text-xs uppercase">Quota:</span> <span>{{ hunt.quota }}</span>
                </span>
              }
              <div class="mt-1 text-xs" [innerHTML]="hunt.details | detailsHighlight"></div>
            </td>
            <td class="px-6 py-4 align-top bg-gray-800">
              <div>
                <span class="uppercase text-xs font-semibold text-gray-400">Start:</span>
                <span class="mx-1">{{ hunt.startDate | date: 'MM/dd/yyy' }}</span>
              </div>
              <div>
                <span class="uppercase text-xs font-semibold text-gray-400">End:</span>
                <span class="mx-1">{{ hunt.endDate | date: 'MM/dd/yyy' }}</span>
              </div>
            </td>
            <td class="px-6 align-top bg-gray-900">
              <table class="w-full mt-1 mb-1">
                <tr>
                  <td class="px-2 uppercase text-xs font-semibold text-right text-gray-400 border-r border-gray-600">Hunters</td>
                  <td class="px-2">{{ hunt.hunterCount }}</td>
                </tr>
                <tr>
                  <td class="px-2 uppercase text-xs font-semibold text-right text-gray-400 border-r border-gray-600">Bucks</td>
                  <td class="px-2">{{ hunt.bucks }}</td>
                </tr>
                <tr>
                  <td class="px-2 uppercase text-xs font-semibold text-right text-gray-400 border-r border-gray-600">Does</td>
                  <td class="px-2">{{ hunt.does }}</td>
                </tr>
                <tr class="border-t border-gray-600">
                  <td colspan="2" class="px-2 uppercase text-xs font-semibold text-gray-400 text-center whitespace-nowrap">Success Rate</td>
                </tr>
                <tr>
                  <td colspan="2" class="px-2 {{ hunt | successRateColor }} font-bold text-center text-sm">
                    {{ hunt | successRate }}&percnt;
                  </td>
                </tr>
              </table>
            </td>
            <td class="px-6 py-4 align-top border-l border-gray-600">
              hunt.id: <a href="javascript:;" (click)="openHuntForm(hunt)">{{ hunt.id }}</a>
          </tr>
        } @empty {
          <tr class="bg-gray-800 border-b border-gray-700">
            <td colspan="4" class="px-8 py-8 text-gawmas-yeller">
              <div class="flex justify-center">
                <div class="mt-2 flex items-center italic">
                  <ng-icon name="heroFaceFrown" class="mr-1"></ng-icon>
                  <span class="sr-only">Sad face icon</span>
                  <div>
                    <span class="font-medium">No results found</span>.
                  </div>
                </div>
              </div>
            </td>
          </tr>
        }
      }
    </tbody>

} @else {

    <thead class="sr-only">
      <tr>
        <th scope="col" class="px-6 py-3">&nbsp;</th>
        <th scope="col" class="px-6 py-3 w-[135px]">Results</th>
        <th scope="col" class="px-6 py-3 w-[300px]">Weather</th>
      </tr>
    </thead>
    <tbody>
      @if ((hunts$ | async); as hunts) {
        @for (hunt of hunts; track hunt.id) {
          <tr class="bg-gray-800">
            <td colspan="2" class="px-2 pt-2 align-top">
              <div class="flex flex-wrap items-center">
                <div class="text-white font-bold uppercase mr-1">
                  {{ hunt.wmaName }}
                </div>
                @switch (hunt.weapon) {
                  @case ('Firearms') {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-gray-700 text-gray-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                  @case ('Archery') {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-green-900 text-green-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                  @case ('Primitive') {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-yellow-900 text-yellow-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                  @default {
                    <span class="uppercase text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-gray-700 text-gray-300">
                      {{ hunt.weapon }}
                    </span>
                  }
                }
                <span class="text-xs font-medium me-2 px-2.5 py-0.5 rounded-full bg-blue-900 text-blue-300">
                  {{ hunt.startDate | date: 'MM/dd/yyyy' }} - {{ hunt.endDate | date: 'MM/dd/yyyy' }}
                </span>
                @if (hunt.quota) {
                  <span class="text-sm font-medium me-2 px-2.5 py-0.5 rounded-full bg-red-900 text-red-300">
                    <span class="text-xs uppercase">Quota:</span> <span>{{ hunt.quota }}</span>
                  </span>
                }
              </div>
              <div class="mt-1 text-xs" [innerHTML]="hunt.details | detailsHighlight"></div>
            </td>
          </tr>
          <tr class="bg-gray-800 border-b border-gray-600">
            <td class="text-xs px-2 pb-2 align-top max-w-16 bg-gray-900">
              <table class="w-full mt-1 mb-1">
                <tr>
                  <td class="px-2 w-1/2 uppercase text-xs font-semibold text-right text-gray-400 border-r border-gray-600">Hunters</td>
                  <td class="px-2 w-1/2">{{ hunt.hunterCount }}</td>
                </tr>
                <tr>
                  <td class="px-2 w-1/2 uppercase text-xs font-semibold text-right text-gray-400 border-r border-gray-600">Bucks</td>
                  <td class="px-2 w-1/2">{{ hunt.bucks }}</td>
                </tr>
                <tr>
                  <td class="px-2 w-1/2 uppercase text-xs font-semibold text-right text-gray-400 border-r border-gray-600">Does</td>
                  <td class="px-2 w-1/2">{{ hunt.does }}</td>
                </tr>
                <tr class="border-t border-gray-600">
                  <td colspan="2" class="px-2 uppercase text-xs font-semibold text-gray-400 text-center whitespace-nowrap">Success Rate</td>
                </tr>
                <tr>
                  <td colspan="2" class="px-2 {{ hunt | successRateColor }} font-bold text-center text-sm">
                    {{ hunt | successRate }}&percnt;
                  </td>
                </tr>
              </table>
            </td>
            <td class="px-2 border-t border-l border-gray-600 align-top">
               hunt.id: {{ hunt.id }}
            </td>
          </tr>
        } @empty {
          <tr class="bg-gray-800 border-b border-gray-700">
            <td colspan="3" class="px-8 py-8 text-gawmas-yeller flex justify-center">
              <div class="mt-2 flex items-center italic">
                <ng-icon name="heroFaceFrown" class="mr-1"></ng-icon>
                <span class="sr-only">Sad face icon</span>
                <div>
                  <span class="font-medium">No results found</span>.
                </div>
              </div>
            </td>
          </tr>
        }
      }
    </tbody>
  }
</table>

@if ((isEndOfResults$ | async) && (hunts$ | async)!.length > 0) {
  <div class="w-[99%] md:w-[85%] flex justify-center mt-1 mb-12">
    <div class="flex items-center text-gawmas-yeller text-sm">
      <ng-icon name="heroCheckCircle" class="mr-1"></ng-icon>
      <span class="italic uppercase">End of results</span>
    </div>
  </div>
}

<gawmas-hunt-form #huntFormModal />
